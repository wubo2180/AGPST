# ============ general ============ #
GENERAL:
    DESCRIPTION: 'STGCN model configuration'
    MODEL_NAME: 'STGCN'
    DATASET_NAME : "METR-LA"
    DATASET_TYPE : "Traffic speed"
    DATASET_INPUT_LEN : 12
    DATASET_OUTPUT_LEN : 12
    GPU_NUM : 1
    DEVICE: ''
    DATASET_DIR: 'datasets/METR-LA/data_in12_out12.pkl'
    DATASET_INDEX_DIR: 'datasets/METR-LA/index_in12_out12.pkl'
    SCALER_DIR: 'datasets/METR-LA/scaler_in12_out12.pkl'
    ADJ_DIR: "datasets/METR-LA/adj_mx.pkl"
    MODEL_SAVE_PATH: 'checkpoints/METR-LA/'
# ============ optim ============ #
# PEMS-BAY METR-LA PEMS04 PEMS08 PEMS03
OPTIM:
    LR: 0.002
    MOMENTUM: 0.9
    ADAPT_LR: 0.01
    META_LR: 0.001
METRICS: {"MAE": masked_mae, "RMSE": masked_rmse, "MAPE": masked_mape}

# ============ META  ============ #
META:
    SUPPORT_SET_SIZE: 100
    QUERY_SET_SIZE: 100
    NUM_SAMPLED_EDGES: 1000
    UPDATE_SAPCE_STEP: 1
# # ============ environment ============ #
# ENV:
#     ENV : EasyDict()
#     ENV.SEED : 1
#     ENV.CUDNN : EasyDict()
#     ENV.CUDNN.ENABLED : True
# ============ model ============ #
MODEL:
    GWNet:
        num_nodes: 207
        supports: ''
        dropout: 0.3
        gcn_bool: True
        addaptadj: True
        aptinit: None
        in_dim: 2
        out_dim: 12
        residual_channels: 32
        dilation_channels: 32
        skip_channels: 256
        end_channels: 512
        kernel_size: 2
        blocks: 4
        layers: 2

    FROWARD_FEATURES: [0, 1]
    TARGET_FEATURES: [0]
# ============ train ============ #
TRAIN:
    CLIP_GRAD_PARAM:
        max_norm: 5.0
    NUM_EPOCHS: 100
  
    EPOCHS: 100
    NULL_VAL : 0.0
# read data
    DATA_DIR : "datasets/METR-LA"
# dataloader args, optional
    DATA_BATCH_SIZE : 32
    DATA_PREFETCH : False
    DATA_SHUFFLE : True
    DATA_NUM_WORKERS : 2
    DATA_PIN_MEMORY : False

# ============ validate ============ #
VAL:
    INTERVAL : 1
# validating data
    DATA : EasyDict()
# read data
    DATA_DIR : "datasets/METR-LA"
# dataloader args, optional
    DATA_BATCH_SIZE : 32
    DATA_PREFETCH : False
    DATA_SHUFFLE : False
    DATA_NUM_WORKERS : 2
    DATA_PIN_MEMORY : False

# ============ test ============ #
TEST:
    
    INTERVAL : 1
# test data
    
# read data
    DATA_DIR : "datasets/METR-LA"
# dataloader args, optional
    DATA_BATCH_SIZE : 32
    DATA_PREFETCH : False
    DATA_SHUFFLE : False
    DATA_NUM_WORKERS : 2
    DATA_PIN_MEMORY : False
    EVALUATION_HORIZONS : 12


